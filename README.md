# neotree (`ntree`)

A small CLI utility for inspecting directory structure and getting a quick sense of its size and contents.

neotree started as a personal replacement for `tree` on Git Bash, with a few extra conveniences:
grouping files, excluding noise, and roughly estimating how much content a directory contains.
It is mainly used as a lightweight helper before sharing or processing project files.

It works well on **Windows + Git Bash**, where `tree` may be missing or inconsistent.

---

## What it does

- Shows directory structure in a familiar `tree`-like format
- Groups files by directory when needed
- Helps estimate how much content exists (file counts, rough output size)
- Makes it easier to decide what to include or exclude before sharing files

This tool is intentionally simple and opinionated.
It reflects how the author personally inspects and prepares project structures.

For contribution and naming rules, see `CONTRIBUTING.md`.

---

## Features

### Structure inspection

- Tree-compatible directory listing with common filtering and depth controls
- Hidden file visibility (`-a`), directory or file filtering (`-d`, `-F`)
- Sort control (`--dirsfirst`, `--order desc`), ASCII fallback (`--charset ascii`)

### Grouped / compact output

- Group files by directory (`--short`)
- Optional file count hints per group (`--count`)
- Rough character budget control with automatic aggregation (`--budget`)
- Simple language presets for common noise (`--preset python|node|rust|generic`)

### Output helpers

- Markdown wrapper for sharing (`--md`)
- Write output to a file (`-o`)
- Export directory structure as CSV with fixed schema (`--csv`)
- List files only with `-F` (works with default tree output and `--csv`)

---

## Installation

```bash
uv tool install .
```

---

## Usage

### Default (tree-like) output

```bash
ntree
ntree -L 3 --dirsfirst -I node_modules
```

Example:

```text
.
├── src/
│   ├── api/
│   │   ├── auth.py
│   │   └── user.py
│   └── models/
│       └── user.py
└── tests/
    └── test_user.py

2 directories, 4 files
```

---

### Grouped output

```bash
ntree --short
```

Files are grouped by directory without box-drawing characters:

```text
.: README.md, pyproject.toml
src/neotree: __init__.py, cli.py, filter.py, preset.py, scanner.py
src/neotree/formatter: short.py, compat.py, markdown.py
tests: conftest.py, test_cli.py, test_golden_short.py, test_compat.py
```

### With file counts

```bash
ntree --short --count
```

```text
. (files: 2): README.md, pyproject.toml
src/neotree (files: 5): __init__.py, cli.py, filter.py, preset.py, scanner.py
src/neotree/formatter (files: 3): short.py, compat.py, markdown.py
tests (files: 4): conftest.py, test_cli.py, test_golden_short.py, test_compat.py
```

### With a rough output budget

```bash
ntree --short --budget 200
```

When the accumulated output exceeds the budget, deeper directories are collapsed into summary lines.
Directories that fit within the budget are still shown normally:

```text
.: README.md, pyproject.toml
src/neotree: __init__.py, cli.py, filter.py, preset.py, scanner.py
src/neotree/formatter/* (3 files)
tests/golden/* (29 files)
tests: conftest.py, test_cli.py, test_golden_short.py, test_compat.py
```

When aggregation is needed, deeper directories are collapsed first.
Shallower groups are preserved as long as they fit within the budget.
The budget is a rough character count heuristic, not an exact byte or token limit.

---

## Markdown output

`--md` wraps the output in a Markdown code block with a small metadata header.
It can be combined with the default tree output or `--short`.

```bash
ntree --short --md > STRUCTURE.md
```

The output includes a `## Project structure (generated by ntree)` heading,
followed by `- root:`, `- mode:` (and optionally `- budget:`) metadata lines,
then a fenced code block containing the tree output.

Example header:

```text
## Project structure (generated by ntree)

- root: /path/to/project
- mode: short
```

If `--budget` is specified, a `- budget: N` line is included after `mode`.

---

## CSV output

`--csv` exports the directory structure as a flat CSV table.

```bash
ntree --csv
ntree --csv -L 2 -I tests
ntree --csv -F          # files only, no directory rows
ntree --csv -o out.csv  # write to file
```

Example output:

```text
parent_dir,filename,fullpath,depth
myproject,README.md,C:\path\to\myproject\README.md,0
myproject,src,C:\path\to\myproject\src,0
src,api,C:\path\to\myproject\src\api,1
api,auth.py,C:\path\to\myproject\src\api\auth.py,2
api,user.py,C:\path\to\myproject\src\api\user.py,2
```

Column definitions:

| Column       | Content                             | Notes                                          |
| ------------ | ----------------------------------- | ---------------------------------------------- |
| `parent_dir` | Immediate parent directory name     | Root-level entries use the root directory name |
| `filename`   | File or directory name              |                                                |
| `fullpath`   | Absolute path (OS-native separator) | `\` on Windows, `/` on Unix                    |
| `depth`      | Depth from root (0-based)           |                                                |

With `-F / --files-only`, directory rows are omitted:

```bash
ntree --csv -F
```

```text
parent_dir,filename,fullpath,depth
myproject,README.md,C:\path\to\myproject\README.md,0
api,auth.py,C:\path\to\myproject\src\api\auth.py,2
api,user.py,C:\path\to\myproject\src\api\user.py,2
```

`--csv` cannot be combined with `--short` or `--md`.

---

## Option notes

- `--budget` and `--count` only work with `--short`
- `--short` cannot be combined with `-d` or `-F`
- `--csv` cannot be combined with `--short` or `--md`
- `-d` and `-F` cannot be combined
- `-F` works with default tree output and `--csv`
- `-L` accepts integers ≥ 1 only
- `--order` accepts `asc` (default) or `desc`
- `--charset` accepts `unicode` (default) or `ascii`
- `--preset` always includes `generic` exclusions (`.git`, `.DS_Store`, `Thumbs.db`) regardless of the named preset
- `--preset` and `-I` can be combined; both sets of exclusions apply together

---
